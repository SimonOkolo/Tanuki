(()=>{"use strict";var e=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function c(e){try{a(i.next(e))}catch(e){r(e)}}function s(e){try{a(i.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((i=i.apply(e,t||[])).next())}))};const t="https://api.consumet.org/anime/gogoanime";function n(){return e(this,void 0,void 0,(function*(){const e=yield fetch(`${t}/top-airing`);return(yield e.json()).results}))}function i(){return e(this,void 0,void 0,(function*(){const e=yield fetch(`${t}/recent-episodes`);return(yield e.json()).results}))}function o(){return e(this,void 0,void 0,(function*(){const e=yield fetch(`${t}/genre/list`);return yield e.json()}))}function r(e,t){t.innerHTML="",0!==e.length?e.forEach((e=>{const n=function(e){const t=document.createElement("div");return t.classList.add("anime-card"),t.innerHTML=`\n    <img src="${e.image}" alt="${e.title}" onerror="this.src='https://via.placeholder.com/200x300'">\n    <div class="anime-info">\n      <h3>${e.title}</h3>\n      <p>Type: ${e.subOrDub||"N/A"}</p>\n      <p>Status: ${e.status||"N/A"}</p>\n    </div>\n  `,t.addEventListener("click",(()=>{window.location.href=`animeDetails.html?id=${e.id}`})),t}(e);t.appendChild(n)})):t.innerHTML="<p>No results found.</p>"}function c(e){const t=document.getElementById(`${e}LeftArrow`),n=document.getElementById(`${e}RightArrow`),i=document.getElementById(e);t&&n&&i&&(t.addEventListener("click",(()=>s(i,-1))),n.addEventListener("click",(()=>s(i,1))))}function s(e,t){const n=.8*e.offsetWidth*t;e.scrollBy({left:n,behavior:"smooth"})}class a{constructor(e){this.animeList=e,this.currentIndex=0,this.intervalId=null}init(){this.updateSlide(),this.createDots(),this.startSlideshow()}updateSlide(){const e=this.animeList[this.currentIndex],t=document.getElementById("animeImage"),n=document.getElementById("animeTitle"),i=document.getElementById("animeDescription");t&&n&&i&&(t.src=e.image,n.textContent=e.title,i.textContent=e.description||"No description available.")}createDots(){const e=document.getElementById("dotsContainer");e&&(e.innerHTML="",this.animeList.forEach(((t,n)=>{const i=document.createElement("span");i.classList.add("dot"),i.addEventListener("click",(()=>this.showSlide(n))),e.appendChild(i)})),this.updateActiveDot())}showSlide(e){this.currentIndex=e,this.updateSlide(),this.updateActiveDot()}updateActiveDot(){document.querySelectorAll(".dot").forEach(((e,t)=>{e.classList.toggle("active",t===this.currentIndex)}))}nextSlide(){this.currentIndex=(this.currentIndex+1)%this.animeList.length,this.updateSlide(),this.updateActiveDot()}startSlideshow(){this.intervalId=window.setInterval((()=>this.nextSlide()),15e3)}stopSlideshow(){null!==this.intervalId&&clearInterval(this.intervalId)}}function d(){return e=this,t=void 0,d=function*(){const e=document.getElementById("recentAnime"),t=document.getElementById("genresList");if(e&&t)try{const[l,u,h]=yield Promise.all([n(),i(),o()]);new a(l).init(),r(u,e),c("recentAnime"),s=h,(d=t).innerHTML="",s.forEach((e=>{const t=document.createElement("a");t.textContent=e.title,t.href=`genres.html?id=${e.id}&title=${encodeURIComponent(e.title)}`,t.classList.add("genre-link"),d.appendChild(t)}))}catch(e){console.error("Error initializing home page:",e)}var s,d},new((s=void 0)||(s=Promise))((function(n,i){function o(e){try{c(d.next(e))}catch(e){i(e)}}function r(e){try{c(d.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(o,r)}c((d=d.apply(e,t||[])).next())}));var e,t,s,d}function l(){const n=document.getElementById("searchInput"),i=document.getElementById("searchButton"),o=document.getElementById("searchResults");n&&i&&o&&(i.addEventListener("click",(()=>function(n,i){return o=this,c=void 0,a=function*(){if(0!==n.trim().length)try{const o=yield function(n){return e(this,void 0,void 0,(function*(){const e=yield fetch(`${t}/${n}`);return(yield e.json()).results}))}(n);r(o,i)}catch(e){console.error("Error searching anime:",e),i.innerHTML="<p>Error searching for anime. Please try again.</p>"}},new((s=void 0)||(s=Promise))((function(e,t){function n(e){try{r(a.next(e))}catch(e){t(e)}}function i(e){try{r(a.throw(e))}catch(e){t(e)}}function r(t){var o;t.done?e(t.value):(o=t.value,o instanceof s?o:new s((function(e){e(o)}))).then(n,i)}r((a=a.apply(o,c||[])).next())}));var o,c,s,a}(n.value,o))),c("searchResults"))}function u(n,i,o=1){return c=this,s=void 0,d=function*(){const c=document.getElementById("selectedGenre"),s=document.getElementById("animeGrid"),a=document.getElementById("paginationControls");if(c&&s&&a)try{const d=yield function(n,i=1){return e(this,void 0,void 0,(function*(){const e=yield fetch(`${t}/genre/${n}?page=${i}`);return yield e.json()}))}(n,o);c.textContent=`${i} Anime (Page ${o})`,r(d.results,s),function(e,t,n,i,o){if(o.innerHTML="",t>1){const e=document.createElement("button");e.textContent="Previous",e.addEventListener("click",(()=>u(n,i,t-1))),o.appendChild(e)}const r=document.createElement("span");if(r.textContent=`Page ${t}`,o.appendChild(r),e){const e=document.createElement("button");e.textContent="Next",e.addEventListener("click",(()=>u(n,i,t+1))),o.appendChild(e)}}(d.hasNextPage,o,n,i,a)}catch(e){console.error("Error fetching anime by genre:",e),s.innerHTML="<p>Error loading anime. Please try again later.</p>"}},new((a=void 0)||(a=Promise))((function(e,t){function n(e){try{o(d.next(e))}catch(e){t(e)}}function i(e){try{o(d.throw(e))}catch(e){t(e)}}function o(t){var o;t.done?e(t.value):(o=t.value,o instanceof a?o:new a((function(e){e(o)}))).then(n,i)}o((d=d.apply(c,s||[])).next())}));var c,s,a,d}function h(){return n=this,i=void 0,r=function*(){const n=new URLSearchParams(window.location.search).get("id");if(n)try{!function(e){var t;document.title=`Tanuki - ${e.title}`;const n=document.getElementById("animeBanner");n&&(n.style.backgroundImage=`url(${e.image})`),m("animeTitle",e.title),m("animeDescription",e.description||"No description available."),m("animeType",`Type: ${e.subOrDub||"N/A"}`),m("animeStatus",`Status: ${e.status||"N/A"}`),m("animeReleased",`Released: ${e.releaseDate||"N/A"}`),m("animeGenres",`Genres: ${(null===(t=e.genres)||void 0===t?void 0:t.join(", "))||"N/A"}`),function(e,t){const n=document.getElementById("episodesContainer");n&&(n.innerHTML="",e.forEach((e=>{const i=document.createElement("li");i.className="episode-item",i.onclick=()=>window.location.href=`episode.html?id=${t}&ep=${e.number}`;const o=document.createElement("span");o.className="episode-number",o.textContent=`Episode ${e.number}`;const r=document.createElement("span");r.className="episode-title",r.textContent=e.title&&"null"!==e.title?e.title:"No Title",i.appendChild(o),i.appendChild(r),n.appendChild(i)})))}(e.episodes,e.id)}(yield function(n){return e(this,void 0,void 0,(function*(){const e=yield fetch(`${t}/info/${n}`);return yield e.json()}))}(n))}catch(e){console.error("Error fetching anime details:",e),document.body.innerHTML="<h1>Error: Failed to fetch anime details</h1>"}else document.body.innerHTML="<h1>Error: No anime ID provided</h1>"},new((o=void 0)||(o=Promise))((function(e,t){function c(e){try{a(r.next(e))}catch(e){t(e)}}function s(e){try{a(r.throw(e))}catch(e){t(e)}}function a(t){var n;t.done?e(t.value):(n=t.value,n instanceof o?n:new o((function(e){e(n)}))).then(c,s)}a((r=r.apply(n,i||[])).next())}));var n,i,o,r}function m(e,t){const n=document.getElementById(e);n&&(n.textContent=t)}var f=function(e,t,n,i){return new(n||(n=Promise))((function(o,r){function c(e){try{a(i.next(e))}catch(e){r(e)}}function s(e){try{a(i.throw(e))}catch(e){r(e)}}function a(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(c,s)}a((i=i.apply(e,t||[])).next())}))};function p(n,i){return f(this,void 0,void 0,(function*(){try{const o=yield function(n,i){return e(this,void 0,void 0,(function*(){const e=yield fetch(`${t}/watch/${n}?server=${i}`);return yield e.json()}))}(n,i);!function(e){const t=document.getElementById("videoContainer"),n=document.getElementById("qualitySelector");if(t&&n)if(t.innerHTML="",n.innerHTML="",e.sources&&e.sources.length>0){const i=document.createElement("video");i.controls=!0,i.style.width="100%",i.style.maxWidth="1280px",i.style.height="auto",e.sources.sort(((e,t)=>{const n=parseInt(e.quality)||0;return(parseInt(t.quality)||0)-n})).forEach((e=>{const t=document.createElement("source");t.src=e.url,t.type="video/mp4",i.appendChild(t);const o=document.createElement("option");o.value=e.url,o.textContent=e.quality,n.appendChild(o)})),i.onerror=()=>{v("Unable to load video. Please try another source or service.")},t.appendChild(i),n.onchange=e=>{const t=e.target;i.src=t.value,i.play()}}else v("No video sources available for this episode.")}(o)}catch(e){console.error("Error fetching streaming links:",e),v("Failed to fetch streaming links. Please try another source or service.")}}))}function v(e){const t=document.getElementById("errorContainer");t?t.innerHTML=`<p style="color: red; font-weight: bold;">Error: ${e}</p>`:(console.error("Error container not found in the DOM"),alert(`Error: ${e}`))}document.addEventListener("DOMContentLoaded",(()=>{switch(window.location.pathname.split("/").pop()){case"index.html":case"":d();break;case"search.html":l();break;case"genres.html":!function(){const e=new URLSearchParams(window.location.search),t=e.get("id"),n=e.get("title");if(t&&n)u(t,n);else{const e=document.getElementById("selectedGenre"),t=document.getElementById("animeGrid");e&&t&&(e.textContent="No genre selected",t.innerHTML="<p>Please select a genre from the home page.</p>")}}();break;case"animeDetails.html":h();break;case"episode.html":!function(){f(this,void 0,void 0,(function*(){const n=new URLSearchParams(window.location.search),i=n.get("id"),o=n.get("ep");if(i&&o){const n=`${i}-episode-${o}`;try{const i=yield function(n){return e(this,void 0,void 0,(function*(){const e=yield fetch(`${t}/servers/${n}`);return yield e.json()}))}(n);!function(e,t){const n=document.getElementById("serviceSelector");n&&(n.innerHTML="",e.forEach((e=>{const t=document.createElement("option");t.value=e,t.textContent=e,n.appendChild(t)})),n.onchange=e=>{const n=e.target;p(t,n.value)},e.length>0&&p(t,e[0]))}(i,n)}catch(e){console.error("Error fetching episode servers:",e),v("Failed to fetch available servers. Please try again later.")}}else v("Invalid episode information. Please check the URL.")}))}();break;default:console.error("Unknown page")}}))})();